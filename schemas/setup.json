{
    "$schema": "http://json-schema.org/draft-04/schema",
    "title": "JSON Schema for OneSaas setup.*.json files",
    "properties": {
        "$schema": {
            "type": "string",
            "default": "https://sandbox.onesaas.com/schemas/1.0/setup.json",
            "enum": [
                "https://sandbox.onesaas.com/schemas/1.0/setup.json"
            ]
        },
        "Activities": {
            "description": "List of activities that your spoke can do. Activities are used as building blocks to create Triggers & Actions.",
            "type": "object",
            "additionalProperties": {
                "$ref": "#/definitions/activity"
            }
        },
        "Triggers": {
            "description": "The list of Triggers that your spoke supports. A Trigger is an event generated by your spoke that can later trigger an Action into another spoke. E.g. pull-orders.",
            "type": "object",
            "additionalProperties": {
                "$ref": "#/definitions/actiontrigger"
            }
        },
        "Actions": {
            "description": "The list of Actions that your spoke supports.",
            "type": "object",
            "additionalProperties": {
                "$ref": "#/definitions/actiontrigger"
            }
        }
    },
    "additionalProperties": false,
    "definitions": {
        "activity": {
            "properties": {
                "Resource": {
                    "description": "Name of the Resource this activity should use. The resource should be a valid file in located in the Resources\\[name].json",
                    "type": "string",
                    "pattern": "(contact|organization|transaction|product|transactionpayment|financialaccount|classification|taxcode|job|productstock|transactionshipping|configurationproperty|resource|resourcecustomization|webhook|entitysyncreport|accountsummary)\\:[a-z0-9-\\*]*"
                },
                "Direction": {
                    "type": "string",
                    "enum": [
                        "Push",
                        "Pull"
                    ]
                },
                "OperationType": {
                    "type": "string"
                },
                "Title": {
                    "type": "string"
                },
                "Ui": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/activityui"
                    }
                },
                "WebHooks": {
                    "description": "List of WebHook Topics to subscribe when this activity is activated. These topics will be passed to you in your webhook:webhooks resource operations system:create or system:delete to trigger the subscribe/unsubscribe from those webhooks.",
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "Events": {
                    "type": "object",
                    "properties": {
                        "activity:activated": {
                            "type": "array",
                            "items": {
                                "properties": {
                                    "reset:workflowerrors": {
                                        "type": "string"
                                    }
                                }
                            }
                        }
                    }
                },
                "Activities": {
                    "description": "List of dependent sub-activities that will be turned on/off when this activity is activated/deactivated.",
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/activityref"
                    }
                }
            },
            "required": [
                "Resource",
                "Direction"
            ]
        },
        "actiontrigger": {
            "properties": {
                "ShowConditions": {
                    "description": "List of conditions to be verified before this Action or Trigger is made available. These can reference ConfigurationProperties {{name}}:value.",
                    "type": "object",
                    "additionalProperties": {
                        "type": "string",
                        "description": "Name/Value for show condition."
                    }
                },
                "Match": {
                    "description": "List of conditions for matching this Action & Trigger with another Action or Trigger. For example TransactionType:Sale will only match this A/T with another A/C with TransactionType:Sale.",
                    "type": "object",
                    "additionalProperties": {
                        "type": "string",
                        "description": "Name/Value for match"
                    }
                },
                "Activities": {
                    "description": "A list of activities that your Action or Trigger is using.",
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/activityref"
                    }
                },
                "Summaries": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/summary"
                    }
                },
                "Filters": {
                    "description": "List of filters that can be applied to this Action.",
                    "type": "array",
                    "items": {
                        "enum": [
                            "$.ShippingAddress.CountryCode",
                            "$.ShippingAddress.State",
                            "$.ShippingMethod",
                            "$.Date",
                            "$.IsFullyPaid",
                            "$.Tags"
                        ]
                    }
                }
            },
            "required": [
                "Activities"
            ]
        },
        "activityref": {
            "properties": {
                "Name": {
                    "description": "Name of the Activity referenced. Activity has to exist in $.Activities properties.",
                    "type": "string"
                }
            },
            "required": [
                "Name"
            ]
        },
        "summary": {
            "properties": {
                "title": {
                    "type": "string"
                },
                "group": {
                    "type": "string"
                },
                "icon": {
                    "type": "string"
                },
                "showConditions": {
                    "type": "array",
                    "items": {
                        "type": "object"
                    }
                },
                "elseTitle": {
                    "type": "string"
                }
            }
        },
        "activityui": {
            "type": "object"
        }
    }
}